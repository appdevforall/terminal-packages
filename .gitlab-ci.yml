stages:
  - build

build-packages:
  image: ghcr.io/termux/package-builder:latest
  stage: build
  tags:
    - saas-linux-medium-amd64
  variables:
    GIT_SUBMODULE_STRATEGY: recursive
  parallel:
    matrix:
      - ARCH:
        - aarch64
        - x86_64
  script:
    - bash -x build.sh -a "$ARCH" | tee build.log
    - mv build.log output/
    - ls bootstrap-*.zip && mv bootstrap-*.zip output/
  artifacts:
    untracked: false
    when: always
    access: all
    expire_in: "7 days"
    paths:
      - output/**/*

